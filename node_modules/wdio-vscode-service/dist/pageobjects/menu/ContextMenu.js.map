{"version":3,"file":"ContextMenu.js","sourceRoot":"","sources":["../../../src/pageobjects/menu/ContextMenu.ts"],"names":[],"mappings":";;;;;;;;;AAEA,0BAAmC;AACnC,oCAEiB;AACjB,mDAA0E;AAG1E;;;;GAIG;AAEI,IAAM,WAAW,GAAjB,MAAM,WAAY,SAAQ,QAAgC;IAA1D;;QACH;;WAEG;QACI,eAAU,GAAG,aAAsB,CAAA;IAwE9C,CAAC;IAtEG;;;;OAIG;IACH,KAAK,CAAC,OAAO,CAAE,IAAY;QACvB,IAAI;YACA,MAAM,KAAK,GAAG,MAAM,IAAI,CAAC,QAAQ,EAAE,CAAA;YACnC,KAAK,MAAM,IAAI,IAAI,KAAK,EAAE;gBACtB,IAAI,MAAM,IAAI,CAAC,QAAQ,EAAE,KAAK,IAAI,EAAE;oBAChC,OAAO,IAAI,CAAA;iBACd;aACJ;YAED,OAAO,SAAS,CAAA;SACnB;QAAC,OAAO,GAAG,EAAE;YACV,OAAO,SAAS,CAAA;SACnB;IACL,CAAC;IAED;;;OAGG;IACH,KAAK,CAAC,QAAQ;QACV,MAAM,KAAK,GAAsB,EAAE,CAAA;QACnC,MAAM,QAAQ,GAAG,MAAM,IAAI,CAAC,aAAa,CAAA;QAEzC,KAAK,MAAM,OAAO,IAAI,QAAQ,EAAE;YAC5B,MAAM,aAAa,GAAG,MAAM,OAAO,CAAC,YAAY,CAAC,OAAO,CAAC,CAAA;YACzD,IAAI,aAAa,CAAC,OAAO,CAAC,UAAU,CAAC,GAAG,CAAC,EAAE;gBACvC,MAAM,IAAI,GAAG,IAAI,eAAe,CAC5B,IAAI,CAAC,UAAU;gBACf,iEAAiE;gBACjE,OAAc,EACd,IAAI,CACP,CAAA;gBACD,MAAM,IAAI,CAAC,IAAI,EAAE,CAAA;gBACjB,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,CAAA;aACnB;SACJ;QACD,OAAO,KAAK,CAAA;IAChB,CAAC;IAED;;;OAGG;IACH,KAAK,CAAC,KAAK;QACP,MAAM,OAAO,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAA;QAC5B,MAAM,IAAI,CAAC,IAAI,CAAC,gBAAgB,CAAC,EAAE,OAAO,EAAE,IAAI,EAAE,CAAC,CAAA;QACnD,wDAAwD;IAC5D,CAAC;IAED;;OAEG;IACH,KAAK,CAAC,IAAI,CAAE,OAAO,GAAG,IAAI;QACtB,MAAM,CAAC,MAAM,IAAI,CAAC,IAAI,CAAC,CAAC,gBAAgB,CAAC,EAAE,OAAO,EAAE,CAAC,CAAA;QACrD,IAAI,KAAK,GAAG,CAAC,MAAM,IAAI,CAAC,QAAQ,EAAE,CAAC,CAAC,MAAM,CAAA;QAC1C,MAAM,OAAO,CAAC,SAAS,CAAC,KAAK,IAAI,EAAE;YAC/B,MAAM,IAAI,GAAG,CAAC,MAAM,IAAI,CAAC,QAAQ,EAAE,CAAC,CAAC,MAAM,CAAA;YAC3C,IAAI,IAAI,KAAK,KAAK,EAAE;gBAChB,OAAO,IAAI,CAAA;aACd;YACD,KAAK,GAAG,IAAI,CAAA;YACZ,OAAO,KAAK,CAAA;QAChB,CAAC,EAAE,EAAE,OAAO,EAAE,IAAI,EAAE,CAAC,CAAA;QACrB,OAAO,IAAI,CAAA;IACf,CAAC;CACJ,CAAA;AA5EY,WAAW;IADvB,IAAA,qBAAa,EAAC,qBAAmB,CAAC;GACtB,WAAW,CA4EvB;AA5EY,kCAAW;AA+ExB;;;;GAIG;AAEI,IAAM,eAAe,GAArB,MAAM,eAAgB,SAAQ,YAAoC;IAOrE,YACI,QAA0B,EAC1B,IAAkD,EAC3C,UAA4C;QAEnD,KAAK,CAAC,QAAQ,EAAE,IAAI,EAAE,UAAU,CAAC,IAAI,CAAC,CAAA;QAF/B,eAAU,GAAV,UAAU,CAAkC;QATvD;;WAEG;QACI,eAAU,GAAG,aAAsB,CAAA;QACnC,UAAK,GAAG,EAAE,CAAA;IAQjB,CAAC;IAED,KAAK,CAAC,MAAM;QACR,MAAM,IAAI,CAAC,IAAI,CAAC,KAAK,EAAE,CAAA;QACvB,MAAM,IAAA,aAAK,EAAC,GAAG,CAAC,CAAA;QAChB,IAAI,MAAM,IAAI,CAAC,SAAS,EAAE,EAAE;YACxB,MAAM,IAAI,WAAW,CAAC,IAAI,CAAC,UAAU,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,IAAI,EAAE,CAAA;SAC3D;QACD,OAAO,SAAS,CAAA;IACpB,CAAC;IAED,KAAK,CAAC,QAAQ;QACV,MAAM,SAAS,GAAG,MAAM,IAAI,CAAC,UAAU,CAAA;QACvC,OAAO,SAAS,CAAC,YAAY,CAAC,IAAI,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAA;IACzD,CAAC;IAEO,KAAK,CAAC,SAAS;QACnB,IAAI;YACA,MAAM,IAAI,CAAC,YAAY,CAAC,gBAAgB,EAAE,CAAA;YAC1C,OAAO,IAAI,CAAA;SACd;QAAC,OAAO,GAAG,EAAE;YACV,OAAO,KAAK,CAAA;SACf;IACL,CAAC;CACJ,CAAA;AArCY,eAAe;IAD3B,IAAA,qBAAa,EAAC,qBAAmB,CAAC;GACtB,eAAe,CAqC3B;AArCY,0CAAe","sourcesContent":["import type { ChainablePromiseElement } from 'webdriverio'\n\nimport { Menu, MenuItem } from '..'\nimport {\n    PageDecorator, IPageDecorator, VSCodeLocatorMap, sleep\n} from '../utils'\nimport { ContextMenu as ContextMenuLocators } from '../../locators/1.73.0'\n\nexport interface ContextMenu extends IPageDecorator<typeof ContextMenuLocators> {}\n/**\n * Object representing a context menu\n *\n * @category Menu\n */\n@PageDecorator(ContextMenuLocators)\nexport class ContextMenu extends Menu<typeof ContextMenuLocators> {\n    /**\n     * @private\n     */\n    public locatorKey = 'ContextMenu' as const\n\n    /**\n     * Get context menu item by name\n     * @param name name of the item to search by\n     * @returns Promise resolving to ContextMenuItem object\n     */\n    async getItem (name: string): Promise<MenuItem<typeof ContextMenuLocators> | undefined> {\n        try {\n            const items = await this.getItems()\n            for (const item of items) {\n                if (await item.getLabel() === name) {\n                    return item\n                }\n            }\n\n            return undefined\n        } catch (err) {\n            return undefined\n        }\n    }\n\n    /**\n     * Get all context menu items\n     * @returns Promise resolving to array of ContextMenuItem objects\n     */\n    async getItems (): Promise<ContextMenuItem[]> {\n        const items: ContextMenuItem[] = []\n        const elements = await this.itemElement$$\n\n        for (const element of elements) {\n            const classProperty = await element.getAttribute('class')\n            if (classProperty.indexOf('disabled') < 0) {\n                const item = new ContextMenuItem(\n                    this.locatorMap,\n                    // eslint-disable-next-line @typescript-eslint/no-unsafe-argument\n                    element as any,\n                    this\n                )\n                await item.wait()\n                items.push(item)\n            }\n        }\n        return items\n    }\n\n    /**\n     * Close the context menu\n     * @returns Promise resolving when the menu is closed\n     */\n    async close (): Promise<void> {\n        await browser.keys('Escape')\n        await this.elem.waitForDisplayed({ reverse: true })\n        // Todo(Christian): maybe handle stale element exception\n    }\n\n    /**\n     * Wait for the menu to appear and load all its items\n     */\n    async wait (timeout = 5000): Promise<this> {\n        await (await this.elem).waitForDisplayed({ timeout })\n        let items = (await this.getItems()).length\n        await browser.waitUntil(async () => {\n            const temp = (await this.getItems()).length\n            if (temp === items) {\n                return true\n            }\n            items = temp\n            return false\n        }, { timeout: 1000 })\n        return this\n    }\n}\n\nexport interface ContextMenuItem extends IPageDecorator<typeof ContextMenuLocators> {}\n/**\n * Object representing an item of a context menu\n *\n * @category Menu\n */\n@PageDecorator(ContextMenuLocators)\nexport class ContextMenuItem extends MenuItem<typeof ContextMenuLocators> {\n    /**\n     * @private\n     */\n    public locatorKey = 'ContextMenu' as const\n    public label = ''\n\n    constructor (\n        locators: VSCodeLocatorMap,\n        base: ChainablePromiseElement<WebdriverIO.Element>,\n        public parentMenu: Menu<typeof ContextMenuLocators>\n    ) {\n        super(locators, base, parentMenu.elem)\n    }\n\n    async select () {\n        await this.elem.click()\n        await sleep(500)\n        if (await this.isNesting()) {\n            await new ContextMenu(this.locatorMap, this.elem).wait()\n        }\n        return undefined\n    }\n\n    async getLabel (): Promise<string> {\n        const labelItem = await this.itemLabel$\n        return labelItem.getAttribute(this.locators.itemText)\n    }\n\n    private async isNesting (): Promise<boolean> {\n        try {\n            await this.itemNesting$.waitForDisplayed()\n            return true\n        } catch (err) {\n            return false\n        }\n    }\n}\n"]}