"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;
require("source-map-support/register");
var _bluebird = _interopRequireDefault(require("bluebird"));
var _support = require("@appium/support");
var _teen_process = require("teen_process");
var _lodash = _interopRequireDefault(require("lodash"));
var _asyncbox = require("asyncbox");
var _helpers = require("../helpers");
var _logger = _interopRequireDefault(require("../logger.js"));
const PROCESS_INIT_TIMEOUT = 5000;
const COMPANION_PGREP_PATTERN = udid => `${_helpers.IDB_COMPANION_EXECUTABLE}.*--udid[[:space:]]+${udid}`;
const COMPANION_STARTUP_REGEXP = /Started GRPC server on port (\d+)/;
const COMPANION_STARTUP_ERROR_REGEXP = /New Error Built ==> (.+)/;
function buildDaemonArgs(opts = {}) {
  const {
    port,
    grpcPort
  } = opts;
  const result = ['daemon'];
  if (port) {
    result.push('--port', port);
  }
  if (grpcPort) {
    result.push('--grpc-port', grpcPort);
  }
  return result;
}
const systemCallMethods = {};

systemCallMethods.connect = async function connect(opts = {}) {
  const {
    onlineTimeout
  } = opts;
  _logger.default.debug(`Connecting ${_helpers.IDB_EXECUTABLE} service to '${this.udid}'`);
  const binaryPaths = {};
  for (const binary of [_helpers.IDB_EXECUTABLE, _helpers.IDB_COMPANION_EXECUTABLE]) {
    try {
      binaryPaths[binary] = await _support.fs.which(binary);
    } catch (e) {
      throw new Error(`'${binary}' has not been found in PATH. ` + `Is it installed? Read https://www.fbidb.io for more details`);
    }
  }
  let grpcPort = _helpers.DEFAULT_COMPANION_GRPC_PORT;
  _logger.default.debug(`Starting companion: '${binaryPaths[_helpers.IDB_COMPANION_EXECUTABLE]}'`);
  const companionProc = new _teen_process.SubProcess(binaryPaths[_helpers.IDB_COMPANION_EXECUTABLE], ['--udid', this.udid]);
  let listeners = {
    'lines-stdout': null,
    'lines-stderr': null,
    exit: null
  };
  const cleanupListeners = () => {
    _lodash.default.toPairs(listeners).filter(([, v]) => _lodash.default.isFunction(v)).map(([k, v]) => companionProc.removeListener(k, v));
    listeners = {};
  };
  try {
    await companionProc.start(0);
    await new _bluebird.default((resolve, reject) => {
      for (const outType of ['stderr', 'stdout']) {
        const eventName = `lines-${outType}`;
        listeners[eventName] = lines => {
          for (const line of lines) {
            if (_lodash.default.isEmpty(_lodash.default.trim(line))) {
              continue;
            }
            if (this.verbose) {
              _logger.default.debug(`[${_helpers.IDB_COMPANION_EXECUTABLE} ${outType}] ${line}`);
            }

            const readyMatch = COMPANION_STARTUP_REGEXP.exec(line);
            if (readyMatch) {
              grpcPort = readyMatch[1];
              resolve();
            } else {
              const errorMatch = COMPANION_STARTUP_ERROR_REGEXP.exec(line);
              if (errorMatch) {
                reject(new Error(errorMatch[1]));
              }
            }
          }
        };
        companionProc.on(eventName, listeners[eventName]);
      }
      listeners.exit = (code, signal) => {
        cleanupListeners();
        const message = `${_helpers.IDB_COMPANION_EXECUTABLE} exited with code '${code}' from signal '${signal}'`;
        _logger.default.debug(message);
        reject(new Error(message));
      };
      companionProc.once('exit', listeners.exit);
    }).timeout(60000, 'Was unable to acquire a GRPC port after 60 seconds timeout');
  } catch (err) {
    cleanupListeners();
    if (companionProc.isRunning) {
      try {
        await companionProc.stop();
      } catch (ign) {}
    }
    _logger.default.error(`Failed to start ${_helpers.IDB_COMPANION_EXECUTABLE}: ${err.message}`);
    throw err;
  }
  _logger.default.debug(`${_helpers.IDB_COMPANION_EXECUTABLE} is listening on GRPC port '${grpcPort}'`);
  try {
    try {
      await (0, _teen_process.exec)(_helpers.IDB_EXECUTABLE, ['connect', '127.0.0.1', grpcPort]);
    } catch (connectionError) {
      await (0, _asyncbox.retryInterval)(2, 100, async () => {
        await this.disconnect();
        try {
          await (0, _teen_process.exec)(_helpers.IDB_EXECUTABLE, ['kill']);
        } catch (ign) {}
        let isStartupMonitorEnabled = true;
        try {
          const daemon = new _teen_process.SubProcess(_helpers.IDB_EXECUTABLE, buildDaemonArgs({
            port: this.executable.port,
            grpcPort
          }));
          let daemonOutput = '';
          daemon.on('output', (stdout, stderr) => {
            if (isStartupMonitorEnabled && _lodash.default.trim(stdout || stderr)) {
              daemonOutput += `[daemon] ${stdout || stderr}\n`;
            }
          });
          try {
            await daemon.start(null, PROCESS_INIT_TIMEOUT);
            await _bluebird.default.delay(300);
          } catch (ign) {}
          if (daemon.isRunning) {
            _logger.default.debug(`${_helpers.IDB_EXECUTABLE} daemon started on port ${this.executable.port || _helpers.DEFAULT_IDB_PORT}`);
          } else {
            if (!daemonOutput.includes('address already in use')) {
              const message = `${_helpers.IDB_EXECUTABLE} daemon has failed to start: ${daemonOutput}`;
              _logger.default.warn(message);
              throw new Error(message);
            }
            _logger.default.debug(`The port ${this.executable.port || _helpers.DEFAULT_IDB_PORT} is already in use. ` + `Assuming it is used by ${_helpers.IDB_EXECUTABLE} daemon`);
          }
          await (0, _teen_process.exec)(_helpers.IDB_EXECUTABLE, ['connect', '127.0.0.1', grpcPort]);
        } catch (connectionError2) {
          if (connectionError2.stderr || connectionError2.stdout) {
            _logger.default.debug(connectionError2.stderr || connectionError2.stdout);
          }
          throw connectionError2;
        } finally {
          isStartupMonitorEnabled = false;
        }
      });
    }
  } catch (e) {
    if (e.stderr) {
      _logger.default.debug(e.stderr);
    }
    throw new Error(`Cannot start ${_helpers.IDB_EXECUTABLE} service for '${this.udid}'. ` + `Check the server log for more details.`);
  }
  _logger.default.info(`Successfully established the connection to ${_helpers.IDB_EXECUTABLE} service for '${this.udid}'`);
  if (onlineTimeout) {
    await this.waitForDevice(onlineTimeout);
  }
  this.executable.path = binaryPaths[_helpers.IDB_EXECUTABLE];
  this.companion.path = binaryPaths[_helpers.IDB_COMPANION_EXECUTABLE];
};

systemCallMethods.waitForDevice = async function waitForDevice(timeoutMs = 10000) {
  if (!timeoutMs) {
    _logger.default.debug('No timeout is provided, so not waiting until the device is online');
    return;
  }
  _logger.default.debug(`Waiting up to ${timeoutMs}ms for the device to be online`);
  const timer = new _support.timing.Timer().start();
  try {
    await (0, _asyncbox.waitForCondition)(async () => {
      try {
        await this.exec(['ui', 'describe-all']);
        return true;
      } catch (e) {
        return false;
      }
    }, {
      waitMs: timeoutMs,
      intervalMs: 300
    });
  } catch (e) {
    throw new Error(`The device '${this.udid}' is not responding to idb requests after ${timeoutMs}ms timeout. ` + `Original error: ${e.stderr || e.message}`);
  }
  _logger.default.debug(`The device '${this.udid}' is online and ready to accept idb commands in ` + `${timer.getDuration().asSeconds.toFixed(3)}s`);
};

systemCallMethods.disconnect = async function disconnect() {
  _logger.default.debug(`Disconnecting ${_helpers.IDB_EXECUTABLE} service from '${this.udid}'`);
  try {
    await (0, _teen_process.exec)(this.executable.path, ['disconnect', this.udid]);
  } catch (ign) {}
  const companionPids = await (0, _helpers.getPids)(COMPANION_PGREP_PATTERN(this.udid));
  if (_lodash.default.isEmpty(companionPids)) {
    return;
  }
  _logger.default.debug(`Cleaning up ${companionPids.length} obsolete ${_helpers.IDB_COMPANION_EXECUTABLE} ` + `process${companionPids.length === 1 ? '' : 'es'}`);
  await (0, _teen_process.exec)('kill', ['-2', ...companionPids]);
};

systemCallMethods.exec = async function exec(cmd, args = [], opts = {}) {
  if (!cmd) {
    throw new Error('You need to pass in a command to exec()');
  }
  cmd = _lodash.default.isArray(cmd) ? cmd : [cmd];
  opts = _lodash.default.cloneDeep(opts);
  opts.timeout = opts.timeout || this.execTimeout || _helpers.DEFAULT_IDB_EXEC_TIMEOUT;
  opts.timeoutCapName = opts.timeoutCapName || 'execTimeout';

  const fullArgs = [...cmd, ...this.executable.defaultArgs, ...args];
  _logger.default.debug(`Running '${this.executable.path} ${_support.util.quote(fullArgs)}'`);
  try {
    const {
      stdout
    } = await (0, _teen_process.exec)(this.executable.path, fullArgs, opts);
    return stdout;
  } catch (e) {
    if (_support.util.hasValue(e.code)) {
      e.message = `Error executing ${_helpers.IDB_EXECUTABLE}. Original error: '${e.message}'; ` + `Stdout: '${(e.stdout || '').trim()}'; ` + `Stderr: '${(e.stderr || '').trim()}'; ` + `Code: '${e.code}'`;
    } else {
      e.message = `Error executing ${_helpers.IDB_EXECUTABLE}. Original error: '${e.message}'. ` + `Try to increase the ${opts.timeout}ms ${_helpers.IDB_EXECUTABLE} execution timeout represented by '${opts.timeoutCapName}' capability`;
    }
    throw e;
  }
};

systemCallMethods.createSubProcess = function createSubProcess(command = [], args = [], opts = {}) {
  const idbArgs = [...command, ...this.executable.defaultArgs, ...args];
  _logger.default.debug(`Creating ${_helpers.IDB_EXECUTABLE} subprocess with args: ${_support.util.quote(args)}`);
  return new _teen_process.SubProcess(this.executable.path, idbArgs, opts);
};
var _default = systemCallMethods;
exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJQUk9DRVNTX0lOSVRfVElNRU9VVCIsIkNPTVBBTklPTl9QR1JFUF9QQVRURVJOIiwidWRpZCIsIklEQl9DT01QQU5JT05fRVhFQ1VUQUJMRSIsIkNPTVBBTklPTl9TVEFSVFVQX1JFR0VYUCIsIkNPTVBBTklPTl9TVEFSVFVQX0VSUk9SX1JFR0VYUCIsImJ1aWxkRGFlbW9uQXJncyIsIm9wdHMiLCJwb3J0IiwiZ3JwY1BvcnQiLCJyZXN1bHQiLCJwdXNoIiwic3lzdGVtQ2FsbE1ldGhvZHMiLCJjb25uZWN0Iiwib25saW5lVGltZW91dCIsImxvZyIsImRlYnVnIiwiSURCX0VYRUNVVEFCTEUiLCJiaW5hcnlQYXRocyIsImJpbmFyeSIsImZzIiwid2hpY2giLCJlIiwiRXJyb3IiLCJERUZBVUxUX0NPTVBBTklPTl9HUlBDX1BPUlQiLCJjb21wYW5pb25Qcm9jIiwiU3ViUHJvY2VzcyIsImxpc3RlbmVycyIsImV4aXQiLCJjbGVhbnVwTGlzdGVuZXJzIiwiXyIsInRvUGFpcnMiLCJmaWx0ZXIiLCJ2IiwiaXNGdW5jdGlvbiIsIm1hcCIsImsiLCJyZW1vdmVMaXN0ZW5lciIsInN0YXJ0IiwiQiIsInJlc29sdmUiLCJyZWplY3QiLCJvdXRUeXBlIiwiZXZlbnROYW1lIiwibGluZXMiLCJsaW5lIiwiaXNFbXB0eSIsInRyaW0iLCJ2ZXJib3NlIiwicmVhZHlNYXRjaCIsImV4ZWMiLCJlcnJvck1hdGNoIiwib24iLCJjb2RlIiwic2lnbmFsIiwibWVzc2FnZSIsIm9uY2UiLCJ0aW1lb3V0IiwiZXJyIiwiaXNSdW5uaW5nIiwic3RvcCIsImlnbiIsImVycm9yIiwidHBFeGVjIiwiY29ubmVjdGlvbkVycm9yIiwicmV0cnlJbnRlcnZhbCIsImRpc2Nvbm5lY3QiLCJpc1N0YXJ0dXBNb25pdG9yRW5hYmxlZCIsImRhZW1vbiIsImV4ZWN1dGFibGUiLCJkYWVtb25PdXRwdXQiLCJzdGRvdXQiLCJzdGRlcnIiLCJkZWxheSIsIkRFRkFVTFRfSURCX1BPUlQiLCJpbmNsdWRlcyIsIndhcm4iLCJjb25uZWN0aW9uRXJyb3IyIiwiaW5mbyIsIndhaXRGb3JEZXZpY2UiLCJwYXRoIiwiY29tcGFuaW9uIiwidGltZW91dE1zIiwidGltZXIiLCJ0aW1pbmciLCJUaW1lciIsIndhaXRGb3JDb25kaXRpb24iLCJ3YWl0TXMiLCJpbnRlcnZhbE1zIiwiZ2V0RHVyYXRpb24iLCJhc1NlY29uZHMiLCJ0b0ZpeGVkIiwiY29tcGFuaW9uUGlkcyIsImdldFBpZHMiLCJsZW5ndGgiLCJjbWQiLCJhcmdzIiwiaXNBcnJheSIsImNsb25lRGVlcCIsImV4ZWNUaW1lb3V0IiwiREVGQVVMVF9JREJfRVhFQ19USU1FT1VUIiwidGltZW91dENhcE5hbWUiLCJmdWxsQXJncyIsImRlZmF1bHRBcmdzIiwidXRpbCIsInF1b3RlIiwiaGFzVmFsdWUiLCJjcmVhdGVTdWJQcm9jZXNzIiwiY29tbWFuZCIsImlkYkFyZ3MiXSwic291cmNlcyI6WyIuLi8uLi8uLi9saWIvdG9vbHMvc3lzdGVtLWNvbW1hbmRzLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBCIGZyb20gJ2JsdWViaXJkJztcbmltcG9ydCB7IGZzLCB1dGlsLCB0aW1pbmcgfSBmcm9tICdAYXBwaXVtL3N1cHBvcnQnO1xuaW1wb3J0IHsgZXhlYyBhcyB0cEV4ZWMsIFN1YlByb2Nlc3MgfSBmcm9tICd0ZWVuX3Byb2Nlc3MnO1xuaW1wb3J0IF8gZnJvbSAnbG9kYXNoJztcbmltcG9ydCB7IHJldHJ5SW50ZXJ2YWwsIHdhaXRGb3JDb25kaXRpb24gfSBmcm9tICdhc3luY2JveCc7XG5pbXBvcnQge1xuICBnZXRQaWRzLCBERUZBVUxUX0lEQl9FWEVDX1RJTUVPVVQsIElEQl9FWEVDVVRBQkxFLFxuICBJREJfQ09NUEFOSU9OX0VYRUNVVEFCTEUsIERFRkFVTFRfSURCX1BPUlQsIERFRkFVTFRfQ09NUEFOSU9OX0dSUENfUE9SVCxcbn0gZnJvbSAnLi4vaGVscGVycyc7XG5pbXBvcnQgbG9nIGZyb20gJy4uL2xvZ2dlci5qcyc7XG5cblxuY29uc3QgUFJPQ0VTU19JTklUX1RJTUVPVVQgPSA1MDAwO1xuY29uc3QgQ09NUEFOSU9OX1BHUkVQX1BBVFRFUk4gPSAodWRpZCkgPT5cbiAgYCR7SURCX0NPTVBBTklPTl9FWEVDVVRBQkxFfS4qLS11ZGlkW1s6c3BhY2U6XV0rJHt1ZGlkfWA7XG5jb25zdCBDT01QQU5JT05fU1RBUlRVUF9SRUdFWFAgPSAvU3RhcnRlZCBHUlBDIHNlcnZlciBvbiBwb3J0IChcXGQrKS87XG5jb25zdCBDT01QQU5JT05fU1RBUlRVUF9FUlJPUl9SRUdFWFAgPSAvTmV3IEVycm9yIEJ1aWx0ID09PiAoLispLztcblxuZnVuY3Rpb24gYnVpbGREYWVtb25BcmdzIChvcHRzID0ge30pIHtcbiAgY29uc3Qge1xuICAgIHBvcnQsXG4gICAgZ3JwY1BvcnQsXG4gIH0gPSBvcHRzO1xuXG4gIGNvbnN0IHJlc3VsdCA9IFsnZGFlbW9uJ107XG4gIGlmIChwb3J0KSB7XG4gICAgcmVzdWx0LnB1c2goJy0tcG9ydCcsIHBvcnQpO1xuICB9XG4gIGlmIChncnBjUG9ydCkge1xuICAgIHJlc3VsdC5wdXNoKCctLWdycGMtcG9ydCcsIGdycGNQb3J0KTtcbiAgfVxuICByZXR1cm4gcmVzdWx0O1xufVxuXG5cbmNvbnN0IHN5c3RlbUNhbGxNZXRob2RzID0ge307XG5cbi8qKlxuICogQHR5cGVkZWYge09iamVjdH0gQ29ubmVjdE9wdGlvbnNcbiAqXG4gKiBAcHJvcGVydHkgez9udW1iZXJ9IG9ubGluZVRpbWVvdXQgLSBUaGUgbnVtYmVyIG9mIG1pbGxpc2Vjb25kcyB0byB3YWl0XG4gKiB1bnRpbCB0aGUgZGV2aWNlIHVuZGVyIHRlc3RzIGlzIG9ubGluZS4gTm8gd2FpdCBpcyBnb2luZyB0byBiZSBwZXJmb3JtZWRcbiAqIGlmIHRoZSB0aW1lb3V0IGlzIG5vdCBzZXQuIEl0IGlzIHJlY29tbWVuZGVkIHRvIHByb3ZpZGUgdGhpcyB2YWx1ZSBpZlxuICogYGNvbm5lY3RgIGlzIGNhbGxlZCByaWdodCBhZnRlciBkZXZpY2UgaXMgYm9vdGVkLCBzbyBub3QgYWxsIHRoZSByZXF1aXJlZFxuICogZGV2aWNlIHNlcnZpY2VzIGhhdmUgYmVlbiBzdGFydGVkIHlldC5cbiAqL1xuXG4vKipcbiAqIEluaXRpYWxpemVzIGlkYiBhbmQgY29tcGFuaW9uIHByb2Nlc3NlcyBpZiBuZWNlc3NhcnkgYW5kXG4gKiBhc3NpZ25zIHBhdGggcHJvcGVydGllcy4gSXQgaXMgbWFuZGF0b3J5IHRvIGNhbGwgdGhpcyBtZXRob2QgYmVmb3JlXG4gKiBvbmUgY2FuIHN0YXJ0IHVzaW5nIElEQiBpbnN0YW5jZSxcbiAqXG4gKiBAdGhyb3dzIHtFcnJvcn0gSWYgbWFuZGF0b3J5IGlkYiBleGVjdXRhYmxlcyBhcmUgbm90IHByZXNlbnQgb24gdGhlXG4gKiBsb2NhbGhvc3Qgb3IgdGhlcmUgd2FzIGEgZmFpbHVyZSB3aGlsZSBzdGFydGluZy9kZXRlY3RpbmcgdGhlbVxuICovXG5zeXN0ZW1DYWxsTWV0aG9kcy5jb25uZWN0ID0gYXN5bmMgZnVuY3Rpb24gY29ubmVjdCAob3B0cyA9IHt9KSB7XG4gIGNvbnN0IHtcbiAgICBvbmxpbmVUaW1lb3V0LFxuICB9ID0gb3B0cztcblxuICBsb2cuZGVidWcoYENvbm5lY3RpbmcgJHtJREJfRVhFQ1VUQUJMRX0gc2VydmljZSB0byAnJHt0aGlzLnVkaWR9J2ApO1xuXG4gIGNvbnN0IGJpbmFyeVBhdGhzID0ge307XG4gIGZvciAoY29uc3QgYmluYXJ5IG9mIFtJREJfRVhFQ1VUQUJMRSwgSURCX0NPTVBBTklPTl9FWEVDVVRBQkxFXSkge1xuICAgIHRyeSB7XG4gICAgICBiaW5hcnlQYXRoc1tiaW5hcnldID0gYXdhaXQgZnMud2hpY2goYmluYXJ5KTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYCcke2JpbmFyeX0nIGhhcyBub3QgYmVlbiBmb3VuZCBpbiBQQVRILiBgICtcbiAgICAgICAgYElzIGl0IGluc3RhbGxlZD8gUmVhZCBodHRwczovL3d3dy5mYmlkYi5pbyBmb3IgbW9yZSBkZXRhaWxzYCk7XG4gICAgfVxuICB9XG5cbiAgbGV0IGdycGNQb3J0ID0gREVGQVVMVF9DT01QQU5JT05fR1JQQ19QT1JUO1xuICBsb2cuZGVidWcoYFN0YXJ0aW5nIGNvbXBhbmlvbjogJyR7YmluYXJ5UGF0aHNbSURCX0NPTVBBTklPTl9FWEVDVVRBQkxFXX0nYCk7XG4gIGNvbnN0IGNvbXBhbmlvblByb2MgPSBuZXcgU3ViUHJvY2VzcyhiaW5hcnlQYXRoc1tJREJfQ09NUEFOSU9OX0VYRUNVVEFCTEVdLCBbJy0tdWRpZCcsIHRoaXMudWRpZF0pO1xuICBsZXQgbGlzdGVuZXJzID0ge1xuICAgICdsaW5lcy1zdGRvdXQnOiBudWxsLFxuICAgICdsaW5lcy1zdGRlcnInOiBudWxsLFxuICAgIGV4aXQ6IG51bGwsXG4gIH07XG4gIGNvbnN0IGNsZWFudXBMaXN0ZW5lcnMgPSAoKSA9PiB7XG4gICAgXy50b1BhaXJzKGxpc3RlbmVycylcbiAgICAgIC5maWx0ZXIoKFssIHZdKSA9PiBfLmlzRnVuY3Rpb24odikpXG4gICAgICAubWFwKChbaywgdl0pID0+IGNvbXBhbmlvblByb2MucmVtb3ZlTGlzdGVuZXIoaywgdikpO1xuICAgIGxpc3RlbmVycyA9IHt9O1xuICB9O1xuICB0cnkge1xuICAgIGF3YWl0IGNvbXBhbmlvblByb2Muc3RhcnQoMCk7XG5cbiAgICBhd2FpdCBuZXcgQigocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICBmb3IgKGNvbnN0IG91dFR5cGUgb2YgWydzdGRlcnInLCAnc3Rkb3V0J10pIHtcbiAgICAgICAgY29uc3QgZXZlbnROYW1lID0gYGxpbmVzLSR7b3V0VHlwZX1gO1xuICAgICAgICBsaXN0ZW5lcnNbZXZlbnROYW1lXSA9IChsaW5lcykgPT4ge1xuICAgICAgICAgIGZvciAoY29uc3QgbGluZSBvZiBsaW5lcykge1xuICAgICAgICAgICAgaWYgKF8uaXNFbXB0eShfLnRyaW0obGluZSkpKSB7XG4gICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAodGhpcy52ZXJib3NlKSB7XG4gICAgICAgICAgICAgIGxvZy5kZWJ1ZyhgWyR7SURCX0NPTVBBTklPTl9FWEVDVVRBQkxFfSAke291dFR5cGV9XSAke2xpbmV9YCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIGNoZWNrIGZvciBtYXJrZXIgdGhhdCB0aGluZ3MgYXJlIHJlYWR5IHRvIGdvXG4gICAgICAgICAgICBjb25zdCByZWFkeU1hdGNoID0gQ09NUEFOSU9OX1NUQVJUVVBfUkVHRVhQLmV4ZWMobGluZSk7XG4gICAgICAgICAgICBpZiAocmVhZHlNYXRjaCkge1xuICAgICAgICAgICAgICAvLyBmaW5kIHRoZSBwb3J0IGFuZCBzYXZlLCBzbyBpZGIgY2FuIGNvbm5lY3RcbiAgICAgICAgICAgICAgZ3JwY1BvcnQgPSByZWFkeU1hdGNoWzFdO1xuICAgICAgICAgICAgICByZXNvbHZlKCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAvLyBjaGVjayBpZiB0aGVyZSBoYXMgYmVlbiBhbiBlcnJvclxuICAgICAgICAgICAgICBjb25zdCBlcnJvck1hdGNoID0gQ09NUEFOSU9OX1NUQVJUVVBfRVJST1JfUkVHRVhQLmV4ZWMobGluZSk7XG4gICAgICAgICAgICAgIGlmIChlcnJvck1hdGNoKSB7XG4gICAgICAgICAgICAgICAgcmVqZWN0KG5ldyBFcnJvcihlcnJvck1hdGNoWzFdKSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIGNvbXBhbmlvblByb2Mub24oZXZlbnROYW1lLCBsaXN0ZW5lcnNbZXZlbnROYW1lXSk7XG4gICAgICB9XG5cbiAgICAgIGxpc3RlbmVycy5leGl0ID0gKGNvZGUsIHNpZ25hbCkgPT4ge1xuICAgICAgICBjbGVhbnVwTGlzdGVuZXJzKCk7XG4gICAgICAgIGNvbnN0IG1lc3NhZ2UgPSBgJHtJREJfQ09NUEFOSU9OX0VYRUNVVEFCTEV9IGV4aXRlZCB3aXRoIGNvZGUgJyR7Y29kZX0nIGZyb20gc2lnbmFsICcke3NpZ25hbH0nYDtcbiAgICAgICAgbG9nLmRlYnVnKG1lc3NhZ2UpO1xuICAgICAgICByZWplY3QobmV3IEVycm9yKG1lc3NhZ2UpKTtcbiAgICAgIH07XG4gICAgICBjb21wYW5pb25Qcm9jLm9uY2UoJ2V4aXQnLCBsaXN0ZW5lcnMuZXhpdCk7XG4gICAgfSkudGltZW91dCg2MDAwMCwgJ1dhcyB1bmFibGUgdG8gYWNxdWlyZSBhIEdSUEMgcG9ydCBhZnRlciA2MCBzZWNvbmRzIHRpbWVvdXQnKTtcbiAgfSBjYXRjaCAoZXJyKSB7XG4gICAgY2xlYW51cExpc3RlbmVycygpO1xuICAgIGlmIChjb21wYW5pb25Qcm9jLmlzUnVubmluZykge1xuICAgICAgdHJ5IHtcbiAgICAgICAgYXdhaXQgY29tcGFuaW9uUHJvYy5zdG9wKCk7XG4gICAgICB9IGNhdGNoIChpZ24pIHt9XG4gICAgfVxuICAgIGxvZy5lcnJvcihgRmFpbGVkIHRvIHN0YXJ0ICR7SURCX0NPTVBBTklPTl9FWEVDVVRBQkxFfTogJHtlcnIubWVzc2FnZX1gKTtcbiAgICB0aHJvdyBlcnI7XG4gIH1cblxuICBsb2cuZGVidWcoYCR7SURCX0NPTVBBTklPTl9FWEVDVVRBQkxFfSBpcyBsaXN0ZW5pbmcgb24gR1JQQyBwb3J0ICcke2dycGNQb3J0fSdgKTtcblxuICB0cnkge1xuICAgIHRyeSB7XG4gICAgICBhd2FpdCB0cEV4ZWMoSURCX0VYRUNVVEFCTEUsIFsnY29ubmVjdCcsICcxMjcuMC4wLjEnLCBncnBjUG9ydF0pO1xuICAgIH0gY2F0Y2ggKGNvbm5lY3Rpb25FcnJvcikge1xuICAgICAgYXdhaXQgcmV0cnlJbnRlcnZhbCgyLCAxMDAsIGFzeW5jICgpID0+IHtcbiAgICAgICAgYXdhaXQgdGhpcy5kaXNjb25uZWN0KCk7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgYXdhaXQgdHBFeGVjKElEQl9FWEVDVVRBQkxFLCBbJ2tpbGwnXSk7XG4gICAgICAgIH0gY2F0Y2ggKGlnbikge31cbiAgICAgICAgbGV0IGlzU3RhcnR1cE1vbml0b3JFbmFibGVkID0gdHJ1ZTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBjb25zdCBkYWVtb24gPSBuZXcgU3ViUHJvY2VzcyhJREJfRVhFQ1VUQUJMRSwgYnVpbGREYWVtb25BcmdzKHtcbiAgICAgICAgICAgIHBvcnQ6IHRoaXMuZXhlY3V0YWJsZS5wb3J0LFxuICAgICAgICAgICAgZ3JwY1BvcnQsXG4gICAgICAgICAgfSkpO1xuICAgICAgICAgIGxldCBkYWVtb25PdXRwdXQgPSAnJztcbiAgICAgICAgICBkYWVtb24ub24oJ291dHB1dCcsIChzdGRvdXQsIHN0ZGVycikgPT4ge1xuICAgICAgICAgICAgaWYgKGlzU3RhcnR1cE1vbml0b3JFbmFibGVkICYmIF8udHJpbShzdGRvdXQgfHwgc3RkZXJyKSkge1xuICAgICAgICAgICAgICBkYWVtb25PdXRwdXQgKz0gYFtkYWVtb25dICR7c3Rkb3V0IHx8IHN0ZGVycn1cXG5gO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICBhd2FpdCBkYWVtb24uc3RhcnQobnVsbCwgUFJPQ0VTU19JTklUX1RJTUVPVVQpO1xuICAgICAgICAgICAgYXdhaXQgQi5kZWxheSgzMDApO1xuICAgICAgICAgIH0gY2F0Y2ggKGlnbikge31cblxuICAgICAgICAgIGlmIChkYWVtb24uaXNSdW5uaW5nKSB7XG4gICAgICAgICAgICBsb2cuZGVidWcoYCR7SURCX0VYRUNVVEFCTEV9IGRhZW1vbiBzdGFydGVkIG9uIHBvcnQgJHt0aGlzLmV4ZWN1dGFibGUucG9ydCB8fCBERUZBVUxUX0lEQl9QT1JUfWApO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpZiAoIWRhZW1vbk91dHB1dC5pbmNsdWRlcygnYWRkcmVzcyBhbHJlYWR5IGluIHVzZScpKSB7XG4gICAgICAgICAgICAgIGNvbnN0IG1lc3NhZ2UgPSBgJHtJREJfRVhFQ1VUQUJMRX0gZGFlbW9uIGhhcyBmYWlsZWQgdG8gc3RhcnQ6ICR7ZGFlbW9uT3V0cHV0fWA7XG4gICAgICAgICAgICAgIGxvZy53YXJuKG1lc3NhZ2UpO1xuICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IobWVzc2FnZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBsb2cuZGVidWcoYFRoZSBwb3J0ICR7dGhpcy5leGVjdXRhYmxlLnBvcnQgfHwgREVGQVVMVF9JREJfUE9SVH0gaXMgYWxyZWFkeSBpbiB1c2UuIGAgK1xuICAgICAgICAgICAgICBgQXNzdW1pbmcgaXQgaXMgdXNlZCBieSAke0lEQl9FWEVDVVRBQkxFfSBkYWVtb25gKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgYXdhaXQgdHBFeGVjKElEQl9FWEVDVVRBQkxFLCBbJ2Nvbm5lY3QnLCAnMTI3LjAuMC4xJywgZ3JwY1BvcnRdKTtcbiAgICAgICAgfSBjYXRjaCAoY29ubmVjdGlvbkVycm9yMikge1xuICAgICAgICAgIGlmIChjb25uZWN0aW9uRXJyb3IyLnN0ZGVyciB8fCBjb25uZWN0aW9uRXJyb3IyLnN0ZG91dCkge1xuICAgICAgICAgICAgbG9nLmRlYnVnKGNvbm5lY3Rpb25FcnJvcjIuc3RkZXJyIHx8IGNvbm5lY3Rpb25FcnJvcjIuc3Rkb3V0KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgdGhyb3cgY29ubmVjdGlvbkVycm9yMjtcbiAgICAgICAgfSBmaW5hbGx5IHtcbiAgICAgICAgICBpc1N0YXJ0dXBNb25pdG9yRW5hYmxlZCA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICBpZiAoZS5zdGRlcnIpIHtcbiAgICAgIGxvZy5kZWJ1ZyhlLnN0ZGVycik7XG4gICAgfVxuICAgIHRocm93IG5ldyBFcnJvcihgQ2Fubm90IHN0YXJ0ICR7SURCX0VYRUNVVEFCTEV9IHNlcnZpY2UgZm9yICcke3RoaXMudWRpZH0nLiBgICtcbiAgICAgIGBDaGVjayB0aGUgc2VydmVyIGxvZyBmb3IgbW9yZSBkZXRhaWxzLmApO1xuICB9XG4gIGxvZy5pbmZvKGBTdWNjZXNzZnVsbHkgZXN0YWJsaXNoZWQgdGhlIGNvbm5lY3Rpb24gdG8gJHtJREJfRVhFQ1VUQUJMRX0gc2VydmljZSBmb3IgJyR7dGhpcy51ZGlkfSdgKTtcblxuICBpZiAob25saW5lVGltZW91dCkge1xuICAgIGF3YWl0IHRoaXMud2FpdEZvckRldmljZShvbmxpbmVUaW1lb3V0KTtcbiAgfVxuXG4gIHRoaXMuZXhlY3V0YWJsZS5wYXRoID0gYmluYXJ5UGF0aHNbSURCX0VYRUNVVEFCTEVdO1xuICB0aGlzLmNvbXBhbmlvbi5wYXRoID0gYmluYXJ5UGF0aHNbSURCX0NPTVBBTklPTl9FWEVDVVRBQkxFXTtcbn07XG5cbi8qKlxuICogQmxvY2tzIHVudGlsIHRoZSBkZXZpY2UgdW5kZXIgdGVzdCBzdGFydHMgcmVzcG9uZGluZyB0byBpZGIgY29tbWFuZHMuXG4gKiBUaGUgZGV2aWNlIG11c3QgYmUgYm9vdGVkL29ubGluZSBhbmQgaWRiIG11c3QgYmUgYWxyZWFkeSBjb25uZWN0ZWQgZm9yIHRoYXQgdG8gaGFwcGVuXG4gKlxuICogQHBhcmFtIHs/bnVtYmVyfSB0aW1lb3V0TXMgWzEwMDAwXSAtIFRoZSBudW1iZXIgb2YgbWlsbGlzZWNvbmRzIHRvIHdhaXRcbiAqIHVudGlsIHRoZSBkZXZpY2UgdW5kZXIgdGVzdHMgaXMgb25saW5lLiBUaGUgbWV0aG9kIHdpbGwgcmV0dXJuIGltbWVkaWF0ZWx5XG4gKiBpZiB0aGUgdGltZW91dCBpcyBmYWxzeVxuICogQHRocm93cyB7RXJyb3J9IGlmIHRoZSBkZXZpY2UgaXMgbm90IHJlc3BvbmRpbmcgd2l0aGluIHRoZSBnaXZlbiB0aW1lb3V0XG4gKi9cbnN5c3RlbUNhbGxNZXRob2RzLndhaXRGb3JEZXZpY2UgPSBhc3luYyBmdW5jdGlvbiB3YWl0Rm9yRGV2aWNlICh0aW1lb3V0TXMgPSAxMDAwMCkge1xuICBpZiAoIXRpbWVvdXRNcykge1xuICAgIGxvZy5kZWJ1ZygnTm8gdGltZW91dCBpcyBwcm92aWRlZCwgc28gbm90IHdhaXRpbmcgdW50aWwgdGhlIGRldmljZSBpcyBvbmxpbmUnKTtcbiAgICByZXR1cm47XG4gIH1cblxuICBsb2cuZGVidWcoYFdhaXRpbmcgdXAgdG8gJHt0aW1lb3V0TXN9bXMgZm9yIHRoZSBkZXZpY2UgdG8gYmUgb25saW5lYCk7XG4gIGNvbnN0IHRpbWVyID0gbmV3IHRpbWluZy5UaW1lcigpLnN0YXJ0KCk7XG4gIHRyeSB7XG4gICAgYXdhaXQgd2FpdEZvckNvbmRpdGlvbihhc3luYyAoKSA9PiB7XG4gICAgICB0cnkge1xuICAgICAgICBhd2FpdCB0aGlzLmV4ZWMoWyd1aScsICdkZXNjcmliZS1hbGwnXSk7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgfSwge1xuICAgICAgd2FpdE1zOiB0aW1lb3V0TXMsXG4gICAgICBpbnRlcnZhbE1zOiAzMDAsXG4gICAgfSk7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoYFRoZSBkZXZpY2UgJyR7dGhpcy51ZGlkfScgaXMgbm90IHJlc3BvbmRpbmcgdG8gaWRiIHJlcXVlc3RzIGFmdGVyICR7dGltZW91dE1zfW1zIHRpbWVvdXQuIGAgK1xuICAgICAgYE9yaWdpbmFsIGVycm9yOiAke2Uuc3RkZXJyIHx8IGUubWVzc2FnZX1gKTtcbiAgfVxuICBsb2cuZGVidWcoYFRoZSBkZXZpY2UgJyR7dGhpcy51ZGlkfScgaXMgb25saW5lIGFuZCByZWFkeSB0byBhY2NlcHQgaWRiIGNvbW1hbmRzIGluIGAgK1xuICAgIGAke3RpbWVyLmdldER1cmF0aW9uKCkuYXNTZWNvbmRzLnRvRml4ZWQoMyl9c2ApO1xufTtcblxuLyoqXG4gKiBQZXJmb3JtcyBjbGVhbnVwIG9mIG9ic29sZXRlIGNvbXBhbmlvbiBwcm9jZXNzZXNcbiAqIFRoZSBkYWVtb24gcHJvY2VzcyBpcyBsZWZ0IHVudG91Y2hlZCwgYmVjYXVzZSBraWxsaW5nIGl0IG1pZ2h0XG4gKiBwb3RlbnRpYWxseSBhZmZlY3Qgb3RoZXIgcGFyYWxsZWwgc2Vzc2lvbnMuIE5vdGhpbmdcbiAqIGlzIGRvbmUgaWYgbm8gb2Jzb2xldGUgcHJvY2Vzc2VzIGFyZSBmb3VuZC5cbiAqL1xuc3lzdGVtQ2FsbE1ldGhvZHMuZGlzY29ubmVjdCA9IGFzeW5jIGZ1bmN0aW9uIGRpc2Nvbm5lY3QgKCkge1xuICBsb2cuZGVidWcoYERpc2Nvbm5lY3RpbmcgJHtJREJfRVhFQ1VUQUJMRX0gc2VydmljZSBmcm9tICcke3RoaXMudWRpZH0nYCk7XG5cbiAgdHJ5IHtcbiAgICBhd2FpdCB0cEV4ZWModGhpcy5leGVjdXRhYmxlLnBhdGgsIFsnZGlzY29ubmVjdCcsIHRoaXMudWRpZF0pO1xuICB9IGNhdGNoIChpZ24pIHt9XG5cbiAgY29uc3QgY29tcGFuaW9uUGlkcyA9IGF3YWl0IGdldFBpZHMoQ09NUEFOSU9OX1BHUkVQX1BBVFRFUk4odGhpcy51ZGlkKSk7XG4gIGlmIChfLmlzRW1wdHkoY29tcGFuaW9uUGlkcykpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICBsb2cuZGVidWcoYENsZWFuaW5nIHVwICR7Y29tcGFuaW9uUGlkcy5sZW5ndGh9IG9ic29sZXRlICR7SURCX0NPTVBBTklPTl9FWEVDVVRBQkxFfSBgICtcbiAgICBgcHJvY2VzcyR7Y29tcGFuaW9uUGlkcy5sZW5ndGggPT09IDEgPyAnJyA6ICdlcyd9YCk7XG4gIGF3YWl0IHRwRXhlYygna2lsbCcsIFsnLTInLCAuLi5jb21wYW5pb25QaWRzXSk7XG59O1xuXG4vKipcbiAqIEV4ZWN1dGUgdGhlIGdpdmVuIGlkYiBjb21tYW5kLlxuICpcbiAqIEBwYXJhbSB7QXJyYXkuPHN0cmluZz59IGNtZCAtIFRoZSBhY3R1YWwgaWRiIGNvbW1hbmQgd2l0aG91dCBhcmd1bWVudHMvcGFyYW1zLlxuICogQHBhcmFtIHtBcnJheTxzdHJpbmc+fSBhcmdzIC0gT3B0aW9uYWwgY29tbWFuZCBhcmd1bWVudHMuXG4gKiBAcGFyYW0ge09iamVjdH0gb3B0cyAtIEFkZGl0aW9uYWwgb3B0aW9ucyBtYXBwaW5nLiBTZWVcbiAqICAgICAgICAgICAgICAgICAgICAgICAge0BsaW5rIGh0dHBzOi8vZ2l0aHViLmNvbS9hcHBpdW0vbm9kZS10ZWVuX3Byb2Nlc3N9XG4gKiAgICAgICAgICAgICAgICAgICAgICAgIGZvciBtb3JlIGRldGFpbHMuXG4gKiBAcmV0dXJuIHtzdHJpbmd9IC0gQ29tbWFuZCdzIHN0ZG91dC5cbiAqIEB0aHJvd3Mge0Vycm9yfSBJZiB0aGUgY29tbWFuZCByZXR1cm5lZCBub24temVybyBleGl0IGNvZGUuXG4gKi9cbnN5c3RlbUNhbGxNZXRob2RzLmV4ZWMgPSBhc3luYyBmdW5jdGlvbiBleGVjIChjbWQsIGFyZ3MgPSBbXSwgb3B0cyA9IHt9KSB7XG4gIGlmICghY21kKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdZb3UgbmVlZCB0byBwYXNzIGluIGEgY29tbWFuZCB0byBleGVjKCknKTtcbiAgfVxuICBjbWQgPSBfLmlzQXJyYXkoY21kKSA/IGNtZCA6IFtjbWRdO1xuXG4gIG9wdHMgPSBfLmNsb25lRGVlcChvcHRzKTtcbiAgLy8gc2V0dGluZyBkZWZhdWx0IHRpbWVvdXQgZm9yIGVhY2ggY29tbWFuZCB0byBwcmV2ZW50IGluZmluaXRlIHdhaXQuXG4gIG9wdHMudGltZW91dCA9IG9wdHMudGltZW91dCB8fCB0aGlzLmV4ZWNUaW1lb3V0IHx8IERFRkFVTFRfSURCX0VYRUNfVElNRU9VVDtcbiAgb3B0cy50aW1lb3V0Q2FwTmFtZSA9IG9wdHMudGltZW91dENhcE5hbWUgfHwgJ2V4ZWNUaW1lb3V0JzsgLy8gRm9yIGVycm9yIG1lc3NhZ2VcblxuICBjb25zdCBmdWxsQXJncyA9IFsuLi5jbWQsIC4uLnRoaXMuZXhlY3V0YWJsZS5kZWZhdWx0QXJncywgLi4uYXJnc107XG4gIGxvZy5kZWJ1ZyhgUnVubmluZyAnJHt0aGlzLmV4ZWN1dGFibGUucGF0aH0gJHt1dGlsLnF1b3RlKGZ1bGxBcmdzKX0nYCk7XG4gIHRyeSB7XG4gICAgY29uc3Qge3N0ZG91dH0gPSBhd2FpdCB0cEV4ZWModGhpcy5leGVjdXRhYmxlLnBhdGgsIGZ1bGxBcmdzLCBvcHRzKTtcbiAgICByZXR1cm4gc3Rkb3V0O1xuICB9IGNhdGNoIChlKSB7XG4gICAgaWYgKHV0aWwuaGFzVmFsdWUoZS5jb2RlKSkge1xuICAgICAgZS5tZXNzYWdlID0gYEVycm9yIGV4ZWN1dGluZyAke0lEQl9FWEVDVVRBQkxFfS4gT3JpZ2luYWwgZXJyb3I6ICcke2UubWVzc2FnZX0nOyBgICtcbiAgICAgICAgYFN0ZG91dDogJyR7KGUuc3Rkb3V0IHx8ICcnKS50cmltKCl9JzsgYCArXG4gICAgICAgIGBTdGRlcnI6ICckeyhlLnN0ZGVyciB8fCAnJykudHJpbSgpfSc7IGAgK1xuICAgICAgICBgQ29kZTogJyR7ZS5jb2RlfSdgO1xuICAgIH0gZWxzZSB7XG4gICAgICBlLm1lc3NhZ2UgPSBgRXJyb3IgZXhlY3V0aW5nICR7SURCX0VYRUNVVEFCTEV9LiBPcmlnaW5hbCBlcnJvcjogJyR7ZS5tZXNzYWdlfScuIGAgK1xuICAgICAgICBgVHJ5IHRvIGluY3JlYXNlIHRoZSAke29wdHMudGltZW91dH1tcyAke0lEQl9FWEVDVVRBQkxFfSBleGVjdXRpb24gdGltZW91dCByZXByZXNlbnRlZCBieSAnJHtvcHRzLnRpbWVvdXRDYXBOYW1lfScgY2FwYWJpbGl0eWA7XG4gICAgfVxuICAgIHRocm93IGU7XG4gIH1cbn07XG5cbi8qKlxuICogQ3JlYXRlcyBTdWJQcm9jZXNzIGluc3RhbmNlIG9mIGlkYiBmb3IgYmFja2dyb3VuZFxuICogZXhlY3V0aW9uLlxuICpcbiAqIEBwYXJhbSB7QXJyYXk8U3RyaW5nPn0gY29tbWFuZCBkZXNpcmVkIGlkYiBjb21tYW5kIChlLmcuOiBbXCJsYXVuY2hcIl0sIFtcInhjdGVzdFwiLCBcInJ1blwiLCBcInVpXCJdKVxuICogQHBhcmFtIHtBcnJheTxTdHJpbmc+fSBhcmdzIGFkZGl0aW9uYWwgaWRiIGFyZ3VtZW50c1xuICogQHJldHVybnMge1N1YlByb2Nlc3N9XG4gKi9cbnN5c3RlbUNhbGxNZXRob2RzLmNyZWF0ZVN1YlByb2Nlc3MgPSBmdW5jdGlvbiBjcmVhdGVTdWJQcm9jZXNzIChjb21tYW5kID0gW10sIGFyZ3MgPSBbXSwgb3B0cyA9IHt9KSB7XG4gIGNvbnN0IGlkYkFyZ3MgPSBbLi4uY29tbWFuZCwgLi4udGhpcy5leGVjdXRhYmxlLmRlZmF1bHRBcmdzLCAuLi5hcmdzXTtcbiAgbG9nLmRlYnVnKGBDcmVhdGluZyAke0lEQl9FWEVDVVRBQkxFfSBzdWJwcm9jZXNzIHdpdGggYXJnczogJHt1dGlsLnF1b3RlKGFyZ3MpfWApO1xuICByZXR1cm4gbmV3IFN1YlByb2Nlc3ModGhpcy5leGVjdXRhYmxlLnBhdGgsIGlkYkFyZ3MsIG9wdHMpO1xufTtcblxuZXhwb3J0IGRlZmF1bHQgc3lzdGVtQ2FsbE1ldGhvZHM7XG4iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSUE7QUFHQSxNQUFNQSxvQkFBb0IsR0FBRyxJQUFJO0FBQ2pDLE1BQU1DLHVCQUF1QixHQUFJQyxJQUFJLElBQ2xDLEdBQUVDLGlDQUF5Qix1QkFBc0JELElBQUssRUFBQztBQUMxRCxNQUFNRSx3QkFBd0IsR0FBRyxtQ0FBbUM7QUFDcEUsTUFBTUMsOEJBQThCLEdBQUcsMEJBQTBCO0FBRWpFLFNBQVNDLGVBQWUsQ0FBRUMsSUFBSSxHQUFHLENBQUMsQ0FBQyxFQUFFO0VBQ25DLE1BQU07SUFDSkMsSUFBSTtJQUNKQztFQUNGLENBQUMsR0FBR0YsSUFBSTtFQUVSLE1BQU1HLE1BQU0sR0FBRyxDQUFDLFFBQVEsQ0FBQztFQUN6QixJQUFJRixJQUFJLEVBQUU7SUFDUkUsTUFBTSxDQUFDQyxJQUFJLENBQUMsUUFBUSxFQUFFSCxJQUFJLENBQUM7RUFDN0I7RUFDQSxJQUFJQyxRQUFRLEVBQUU7SUFDWkMsTUFBTSxDQUFDQyxJQUFJLENBQUMsYUFBYSxFQUFFRixRQUFRLENBQUM7RUFDdEM7RUFDQSxPQUFPQyxNQUFNO0FBQ2Y7QUFHQSxNQUFNRSxpQkFBaUIsR0FBRyxDQUFDLENBQUM7O0FBb0I1QkEsaUJBQWlCLENBQUNDLE9BQU8sR0FBRyxlQUFlQSxPQUFPLENBQUVOLElBQUksR0FBRyxDQUFDLENBQUMsRUFBRTtFQUM3RCxNQUFNO0lBQ0pPO0VBQ0YsQ0FBQyxHQUFHUCxJQUFJO0VBRVJRLGVBQUcsQ0FBQ0MsS0FBSyxDQUFFLGNBQWFDLHVCQUFlLGdCQUFlLElBQUksQ0FBQ2YsSUFBSyxHQUFFLENBQUM7RUFFbkUsTUFBTWdCLFdBQVcsR0FBRyxDQUFDLENBQUM7RUFDdEIsS0FBSyxNQUFNQyxNQUFNLElBQUksQ0FBQ0YsdUJBQWMsRUFBRWQsaUNBQXdCLENBQUMsRUFBRTtJQUMvRCxJQUFJO01BQ0ZlLFdBQVcsQ0FBQ0MsTUFBTSxDQUFDLEdBQUcsTUFBTUMsV0FBRSxDQUFDQyxLQUFLLENBQUNGLE1BQU0sQ0FBQztJQUM5QyxDQUFDLENBQUMsT0FBT0csQ0FBQyxFQUFFO01BQ1YsTUFBTSxJQUFJQyxLQUFLLENBQUUsSUFBR0osTUFBTyxnQ0FBK0IsR0FDdkQsNkRBQTRELENBQUM7SUFDbEU7RUFDRjtFQUVBLElBQUlWLFFBQVEsR0FBR2Usb0NBQTJCO0VBQzFDVCxlQUFHLENBQUNDLEtBQUssQ0FBRSx3QkFBdUJFLFdBQVcsQ0FBQ2YsaUNBQXdCLENBQUUsR0FBRSxDQUFDO0VBQzNFLE1BQU1zQixhQUFhLEdBQUcsSUFBSUMsd0JBQVUsQ0FBQ1IsV0FBVyxDQUFDZixpQ0FBd0IsQ0FBQyxFQUFFLENBQUMsUUFBUSxFQUFFLElBQUksQ0FBQ0QsSUFBSSxDQUFDLENBQUM7RUFDbEcsSUFBSXlCLFNBQVMsR0FBRztJQUNkLGNBQWMsRUFBRSxJQUFJO0lBQ3BCLGNBQWMsRUFBRSxJQUFJO0lBQ3BCQyxJQUFJLEVBQUU7RUFDUixDQUFDO0VBQ0QsTUFBTUMsZ0JBQWdCLEdBQUcsTUFBTTtJQUM3QkMsZUFBQyxDQUFDQyxPQUFPLENBQUNKLFNBQVMsQ0FBQyxDQUNqQkssTUFBTSxDQUFDLENBQUMsR0FBR0MsQ0FBQyxDQUFDLEtBQUtILGVBQUMsQ0FBQ0ksVUFBVSxDQUFDRCxDQUFDLENBQUMsQ0FBQyxDQUNsQ0UsR0FBRyxDQUFDLENBQUMsQ0FBQ0MsQ0FBQyxFQUFFSCxDQUFDLENBQUMsS0FBS1IsYUFBYSxDQUFDWSxjQUFjLENBQUNELENBQUMsRUFBRUgsQ0FBQyxDQUFDLENBQUM7SUFDdEROLFNBQVMsR0FBRyxDQUFDLENBQUM7RUFDaEIsQ0FBQztFQUNELElBQUk7SUFDRixNQUFNRixhQUFhLENBQUNhLEtBQUssQ0FBQyxDQUFDLENBQUM7SUFFNUIsTUFBTSxJQUFJQyxpQkFBQyxDQUFDLENBQUNDLE9BQU8sRUFBRUMsTUFBTSxLQUFLO01BQy9CLEtBQUssTUFBTUMsT0FBTyxJQUFJLENBQUMsUUFBUSxFQUFFLFFBQVEsQ0FBQyxFQUFFO1FBQzFDLE1BQU1DLFNBQVMsR0FBSSxTQUFRRCxPQUFRLEVBQUM7UUFDcENmLFNBQVMsQ0FBQ2dCLFNBQVMsQ0FBQyxHQUFJQyxLQUFLLElBQUs7VUFDaEMsS0FBSyxNQUFNQyxJQUFJLElBQUlELEtBQUssRUFBRTtZQUN4QixJQUFJZCxlQUFDLENBQUNnQixPQUFPLENBQUNoQixlQUFDLENBQUNpQixJQUFJLENBQUNGLElBQUksQ0FBQyxDQUFDLEVBQUU7Y0FDM0I7WUFDRjtZQUVBLElBQUksSUFBSSxDQUFDRyxPQUFPLEVBQUU7Y0FDaEJqQyxlQUFHLENBQUNDLEtBQUssQ0FBRSxJQUFHYixpQ0FBeUIsSUFBR3VDLE9BQVEsS0FBSUcsSUFBSyxFQUFDLENBQUM7WUFDL0Q7O1lBR0EsTUFBTUksVUFBVSxHQUFHN0Msd0JBQXdCLENBQUM4QyxJQUFJLENBQUNMLElBQUksQ0FBQztZQUN0RCxJQUFJSSxVQUFVLEVBQUU7Y0FFZHhDLFFBQVEsR0FBR3dDLFVBQVUsQ0FBQyxDQUFDLENBQUM7Y0FDeEJULE9BQU8sRUFBRTtZQUNYLENBQUMsTUFBTTtjQUVMLE1BQU1XLFVBQVUsR0FBRzlDLDhCQUE4QixDQUFDNkMsSUFBSSxDQUFDTCxJQUFJLENBQUM7Y0FDNUQsSUFBSU0sVUFBVSxFQUFFO2dCQUNkVixNQUFNLENBQUMsSUFBSWxCLEtBQUssQ0FBQzRCLFVBQVUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO2NBQ2xDO1lBQ0Y7VUFDRjtRQUNGLENBQUM7UUFDRDFCLGFBQWEsQ0FBQzJCLEVBQUUsQ0FBQ1QsU0FBUyxFQUFFaEIsU0FBUyxDQUFDZ0IsU0FBUyxDQUFDLENBQUM7TUFDbkQ7TUFFQWhCLFNBQVMsQ0FBQ0MsSUFBSSxHQUFHLENBQUN5QixJQUFJLEVBQUVDLE1BQU0sS0FBSztRQUNqQ3pCLGdCQUFnQixFQUFFO1FBQ2xCLE1BQU0wQixPQUFPLEdBQUksR0FBRXBELGlDQUF5QixzQkFBcUJrRCxJQUFLLGtCQUFpQkMsTUFBTyxHQUFFO1FBQ2hHdkMsZUFBRyxDQUFDQyxLQUFLLENBQUN1QyxPQUFPLENBQUM7UUFDbEJkLE1BQU0sQ0FBQyxJQUFJbEIsS0FBSyxDQUFDZ0MsT0FBTyxDQUFDLENBQUM7TUFDNUIsQ0FBQztNQUNEOUIsYUFBYSxDQUFDK0IsSUFBSSxDQUFDLE1BQU0sRUFBRTdCLFNBQVMsQ0FBQ0MsSUFBSSxDQUFDO0lBQzVDLENBQUMsQ0FBQyxDQUFDNkIsT0FBTyxDQUFDLEtBQUssRUFBRSw0REFBNEQsQ0FBQztFQUNqRixDQUFDLENBQUMsT0FBT0MsR0FBRyxFQUFFO0lBQ1o3QixnQkFBZ0IsRUFBRTtJQUNsQixJQUFJSixhQUFhLENBQUNrQyxTQUFTLEVBQUU7TUFDM0IsSUFBSTtRQUNGLE1BQU1sQyxhQUFhLENBQUNtQyxJQUFJLEVBQUU7TUFDNUIsQ0FBQyxDQUFDLE9BQU9DLEdBQUcsRUFBRSxDQUFDO0lBQ2pCO0lBQ0E5QyxlQUFHLENBQUMrQyxLQUFLLENBQUUsbUJBQWtCM0QsaUNBQXlCLEtBQUl1RCxHQUFHLENBQUNILE9BQVEsRUFBQyxDQUFDO0lBQ3hFLE1BQU1HLEdBQUc7RUFDWDtFQUVBM0MsZUFBRyxDQUFDQyxLQUFLLENBQUUsR0FBRWIsaUNBQXlCLCtCQUE4Qk0sUUFBUyxHQUFFLENBQUM7RUFFaEYsSUFBSTtJQUNGLElBQUk7TUFDRixNQUFNLElBQUFzRCxrQkFBTSxFQUFDOUMsdUJBQWMsRUFBRSxDQUFDLFNBQVMsRUFBRSxXQUFXLEVBQUVSLFFBQVEsQ0FBQyxDQUFDO0lBQ2xFLENBQUMsQ0FBQyxPQUFPdUQsZUFBZSxFQUFFO01BQ3hCLE1BQU0sSUFBQUMsdUJBQWEsRUFBQyxDQUFDLEVBQUUsR0FBRyxFQUFFLFlBQVk7UUFDdEMsTUFBTSxJQUFJLENBQUNDLFVBQVUsRUFBRTtRQUN2QixJQUFJO1VBQ0YsTUFBTSxJQUFBSCxrQkFBTSxFQUFDOUMsdUJBQWMsRUFBRSxDQUFDLE1BQU0sQ0FBQyxDQUFDO1FBQ3hDLENBQUMsQ0FBQyxPQUFPNEMsR0FBRyxFQUFFLENBQUM7UUFDZixJQUFJTSx1QkFBdUIsR0FBRyxJQUFJO1FBQ2xDLElBQUk7VUFDRixNQUFNQyxNQUFNLEdBQUcsSUFBSTFDLHdCQUFVLENBQUNULHVCQUFjLEVBQUVYLGVBQWUsQ0FBQztZQUM1REUsSUFBSSxFQUFFLElBQUksQ0FBQzZELFVBQVUsQ0FBQzdELElBQUk7WUFDMUJDO1VBQ0YsQ0FBQyxDQUFDLENBQUM7VUFDSCxJQUFJNkQsWUFBWSxHQUFHLEVBQUU7VUFDckJGLE1BQU0sQ0FBQ2hCLEVBQUUsQ0FBQyxRQUFRLEVBQUUsQ0FBQ21CLE1BQU0sRUFBRUMsTUFBTSxLQUFLO1lBQ3RDLElBQUlMLHVCQUF1QixJQUFJckMsZUFBQyxDQUFDaUIsSUFBSSxDQUFDd0IsTUFBTSxJQUFJQyxNQUFNLENBQUMsRUFBRTtjQUN2REYsWUFBWSxJQUFLLFlBQVdDLE1BQU0sSUFBSUMsTUFBTyxJQUFHO1lBQ2xEO1VBQ0YsQ0FBQyxDQUFDO1VBQ0YsSUFBSTtZQUNGLE1BQU1KLE1BQU0sQ0FBQzlCLEtBQUssQ0FBQyxJQUFJLEVBQUV0QyxvQkFBb0IsQ0FBQztZQUM5QyxNQUFNdUMsaUJBQUMsQ0FBQ2tDLEtBQUssQ0FBQyxHQUFHLENBQUM7VUFDcEIsQ0FBQyxDQUFDLE9BQU9aLEdBQUcsRUFBRSxDQUFDO1VBRWYsSUFBSU8sTUFBTSxDQUFDVCxTQUFTLEVBQUU7WUFDcEI1QyxlQUFHLENBQUNDLEtBQUssQ0FBRSxHQUFFQyx1QkFBZSwyQkFBMEIsSUFBSSxDQUFDb0QsVUFBVSxDQUFDN0QsSUFBSSxJQUFJa0UseUJBQWlCLEVBQUMsQ0FBQztVQUNuRyxDQUFDLE1BQU07WUFDTCxJQUFJLENBQUNKLFlBQVksQ0FBQ0ssUUFBUSxDQUFDLHdCQUF3QixDQUFDLEVBQUU7Y0FDcEQsTUFBTXBCLE9BQU8sR0FBSSxHQUFFdEMsdUJBQWUsZ0NBQStCcUQsWUFBYSxFQUFDO2NBQy9FdkQsZUFBRyxDQUFDNkQsSUFBSSxDQUFDckIsT0FBTyxDQUFDO2NBQ2pCLE1BQU0sSUFBSWhDLEtBQUssQ0FBQ2dDLE9BQU8sQ0FBQztZQUMxQjtZQUNBeEMsZUFBRyxDQUFDQyxLQUFLLENBQUUsWUFBVyxJQUFJLENBQUNxRCxVQUFVLENBQUM3RCxJQUFJLElBQUlrRSx5QkFBaUIsc0JBQXFCLEdBQ2pGLDBCQUF5QnpELHVCQUFlLFNBQVEsQ0FBQztVQUN0RDtVQUNBLE1BQU0sSUFBQThDLGtCQUFNLEVBQUM5Qyx1QkFBYyxFQUFFLENBQUMsU0FBUyxFQUFFLFdBQVcsRUFBRVIsUUFBUSxDQUFDLENBQUM7UUFDbEUsQ0FBQyxDQUFDLE9BQU9vRSxnQkFBZ0IsRUFBRTtVQUN6QixJQUFJQSxnQkFBZ0IsQ0FBQ0wsTUFBTSxJQUFJSyxnQkFBZ0IsQ0FBQ04sTUFBTSxFQUFFO1lBQ3REeEQsZUFBRyxDQUFDQyxLQUFLLENBQUM2RCxnQkFBZ0IsQ0FBQ0wsTUFBTSxJQUFJSyxnQkFBZ0IsQ0FBQ04sTUFBTSxDQUFDO1VBQy9EO1VBQ0EsTUFBTU0sZ0JBQWdCO1FBQ3hCLENBQUMsU0FBUztVQUNSVix1QkFBdUIsR0FBRyxLQUFLO1FBQ2pDO01BQ0YsQ0FBQyxDQUFDO0lBQ0o7RUFDRixDQUFDLENBQUMsT0FBTzdDLENBQUMsRUFBRTtJQUNWLElBQUlBLENBQUMsQ0FBQ2tELE1BQU0sRUFBRTtNQUNaekQsZUFBRyxDQUFDQyxLQUFLLENBQUNNLENBQUMsQ0FBQ2tELE1BQU0sQ0FBQztJQUNyQjtJQUNBLE1BQU0sSUFBSWpELEtBQUssQ0FBRSxnQkFBZU4sdUJBQWUsaUJBQWdCLElBQUksQ0FBQ2YsSUFBSyxLQUFJLEdBQzFFLHdDQUF1QyxDQUFDO0VBQzdDO0VBQ0FhLGVBQUcsQ0FBQytELElBQUksQ0FBRSw4Q0FBNkM3RCx1QkFBZSxpQkFBZ0IsSUFBSSxDQUFDZixJQUFLLEdBQUUsQ0FBQztFQUVuRyxJQUFJWSxhQUFhLEVBQUU7SUFDakIsTUFBTSxJQUFJLENBQUNpRSxhQUFhLENBQUNqRSxhQUFhLENBQUM7RUFDekM7RUFFQSxJQUFJLENBQUN1RCxVQUFVLENBQUNXLElBQUksR0FBRzlELFdBQVcsQ0FBQ0QsdUJBQWMsQ0FBQztFQUNsRCxJQUFJLENBQUNnRSxTQUFTLENBQUNELElBQUksR0FBRzlELFdBQVcsQ0FBQ2YsaUNBQXdCLENBQUM7QUFDN0QsQ0FBQzs7QUFXRFMsaUJBQWlCLENBQUNtRSxhQUFhLEdBQUcsZUFBZUEsYUFBYSxDQUFFRyxTQUFTLEdBQUcsS0FBSyxFQUFFO0VBQ2pGLElBQUksQ0FBQ0EsU0FBUyxFQUFFO0lBQ2RuRSxlQUFHLENBQUNDLEtBQUssQ0FBQyxtRUFBbUUsQ0FBQztJQUM5RTtFQUNGO0VBRUFELGVBQUcsQ0FBQ0MsS0FBSyxDQUFFLGlCQUFnQmtFLFNBQVUsZ0NBQStCLENBQUM7RUFDckUsTUFBTUMsS0FBSyxHQUFHLElBQUlDLGVBQU0sQ0FBQ0MsS0FBSyxFQUFFLENBQUMvQyxLQUFLLEVBQUU7RUFDeEMsSUFBSTtJQUNGLE1BQU0sSUFBQWdELDBCQUFnQixFQUFDLFlBQVk7TUFDakMsSUFBSTtRQUNGLE1BQU0sSUFBSSxDQUFDcEMsSUFBSSxDQUFDLENBQUMsSUFBSSxFQUFFLGNBQWMsQ0FBQyxDQUFDO1FBQ3ZDLE9BQU8sSUFBSTtNQUNiLENBQUMsQ0FBQyxPQUFPNUIsQ0FBQyxFQUFFO1FBQ1YsT0FBTyxLQUFLO01BQ2Q7SUFDRixDQUFDLEVBQUU7TUFDRGlFLE1BQU0sRUFBRUwsU0FBUztNQUNqQk0sVUFBVSxFQUFFO0lBQ2QsQ0FBQyxDQUFDO0VBQ0osQ0FBQyxDQUFDLE9BQU9sRSxDQUFDLEVBQUU7SUFDVixNQUFNLElBQUlDLEtBQUssQ0FBRSxlQUFjLElBQUksQ0FBQ3JCLElBQUssNkNBQTRDZ0YsU0FBVSxjQUFhLEdBQ3pHLG1CQUFrQjVELENBQUMsQ0FBQ2tELE1BQU0sSUFBSWxELENBQUMsQ0FBQ2lDLE9BQVEsRUFBQyxDQUFDO0VBQy9DO0VBQ0F4QyxlQUFHLENBQUNDLEtBQUssQ0FBRSxlQUFjLElBQUksQ0FBQ2QsSUFBSyxrREFBaUQsR0FDakYsR0FBRWlGLEtBQUssQ0FBQ00sV0FBVyxFQUFFLENBQUNDLFNBQVMsQ0FBQ0MsT0FBTyxDQUFDLENBQUMsQ0FBRSxHQUFFLENBQUM7QUFDbkQsQ0FBQzs7QUFRRC9FLGlCQUFpQixDQUFDc0QsVUFBVSxHQUFHLGVBQWVBLFVBQVUsR0FBSTtFQUMxRG5ELGVBQUcsQ0FBQ0MsS0FBSyxDQUFFLGlCQUFnQkMsdUJBQWUsa0JBQWlCLElBQUksQ0FBQ2YsSUFBSyxHQUFFLENBQUM7RUFFeEUsSUFBSTtJQUNGLE1BQU0sSUFBQTZELGtCQUFNLEVBQUMsSUFBSSxDQUFDTSxVQUFVLENBQUNXLElBQUksRUFBRSxDQUFDLFlBQVksRUFBRSxJQUFJLENBQUM5RSxJQUFJLENBQUMsQ0FBQztFQUMvRCxDQUFDLENBQUMsT0FBTzJELEdBQUcsRUFBRSxDQUFDO0VBRWYsTUFBTStCLGFBQWEsR0FBRyxNQUFNLElBQUFDLGdCQUFPLEVBQUM1Rix1QkFBdUIsQ0FBQyxJQUFJLENBQUNDLElBQUksQ0FBQyxDQUFDO0VBQ3ZFLElBQUk0QixlQUFDLENBQUNnQixPQUFPLENBQUM4QyxhQUFhLENBQUMsRUFBRTtJQUM1QjtFQUNGO0VBRUE3RSxlQUFHLENBQUNDLEtBQUssQ0FBRSxlQUFjNEUsYUFBYSxDQUFDRSxNQUFPLGFBQVkzRixpQ0FBeUIsR0FBRSxHQUNsRixVQUFTeUYsYUFBYSxDQUFDRSxNQUFNLEtBQUssQ0FBQyxHQUFHLEVBQUUsR0FBRyxJQUFLLEVBQUMsQ0FBQztFQUNyRCxNQUFNLElBQUEvQixrQkFBTSxFQUFDLE1BQU0sRUFBRSxDQUFDLElBQUksRUFBRSxHQUFHNkIsYUFBYSxDQUFDLENBQUM7QUFDaEQsQ0FBQzs7QUFhRGhGLGlCQUFpQixDQUFDc0MsSUFBSSxHQUFHLGVBQWVBLElBQUksQ0FBRTZDLEdBQUcsRUFBRUMsSUFBSSxHQUFHLEVBQUUsRUFBRXpGLElBQUksR0FBRyxDQUFDLENBQUMsRUFBRTtFQUN2RSxJQUFJLENBQUN3RixHQUFHLEVBQUU7SUFDUixNQUFNLElBQUl4RSxLQUFLLENBQUMseUNBQXlDLENBQUM7RUFDNUQ7RUFDQXdFLEdBQUcsR0FBR2pFLGVBQUMsQ0FBQ21FLE9BQU8sQ0FBQ0YsR0FBRyxDQUFDLEdBQUdBLEdBQUcsR0FBRyxDQUFDQSxHQUFHLENBQUM7RUFFbEN4RixJQUFJLEdBQUd1QixlQUFDLENBQUNvRSxTQUFTLENBQUMzRixJQUFJLENBQUM7RUFFeEJBLElBQUksQ0FBQ2tELE9BQU8sR0FBR2xELElBQUksQ0FBQ2tELE9BQU8sSUFBSSxJQUFJLENBQUMwQyxXQUFXLElBQUlDLGlDQUF3QjtFQUMzRTdGLElBQUksQ0FBQzhGLGNBQWMsR0FBRzlGLElBQUksQ0FBQzhGLGNBQWMsSUFBSSxhQUFhOztFQUUxRCxNQUFNQyxRQUFRLEdBQUcsQ0FBQyxHQUFHUCxHQUFHLEVBQUUsR0FBRyxJQUFJLENBQUMxQixVQUFVLENBQUNrQyxXQUFXLEVBQUUsR0FBR1AsSUFBSSxDQUFDO0VBQ2xFakYsZUFBRyxDQUFDQyxLQUFLLENBQUUsWUFBVyxJQUFJLENBQUNxRCxVQUFVLENBQUNXLElBQUssSUFBR3dCLGFBQUksQ0FBQ0MsS0FBSyxDQUFDSCxRQUFRLENBQUUsR0FBRSxDQUFDO0VBQ3RFLElBQUk7SUFDRixNQUFNO01BQUMvQjtJQUFNLENBQUMsR0FBRyxNQUFNLElBQUFSLGtCQUFNLEVBQUMsSUFBSSxDQUFDTSxVQUFVLENBQUNXLElBQUksRUFBRXNCLFFBQVEsRUFBRS9GLElBQUksQ0FBQztJQUNuRSxPQUFPZ0UsTUFBTTtFQUNmLENBQUMsQ0FBQyxPQUFPakQsQ0FBQyxFQUFFO0lBQ1YsSUFBSWtGLGFBQUksQ0FBQ0UsUUFBUSxDQUFDcEYsQ0FBQyxDQUFDK0IsSUFBSSxDQUFDLEVBQUU7TUFDekIvQixDQUFDLENBQUNpQyxPQUFPLEdBQUksbUJBQWtCdEMsdUJBQWUsc0JBQXFCSyxDQUFDLENBQUNpQyxPQUFRLEtBQUksR0FDOUUsWUFBVyxDQUFDakMsQ0FBQyxDQUFDaUQsTUFBTSxJQUFJLEVBQUUsRUFBRXhCLElBQUksRUFBRyxLQUFJLEdBQ3ZDLFlBQVcsQ0FBQ3pCLENBQUMsQ0FBQ2tELE1BQU0sSUFBSSxFQUFFLEVBQUV6QixJQUFJLEVBQUcsS0FBSSxHQUN2QyxVQUFTekIsQ0FBQyxDQUFDK0IsSUFBSyxHQUFFO0lBQ3ZCLENBQUMsTUFBTTtNQUNML0IsQ0FBQyxDQUFDaUMsT0FBTyxHQUFJLG1CQUFrQnRDLHVCQUFlLHNCQUFxQkssQ0FBQyxDQUFDaUMsT0FBUSxLQUFJLEdBQzlFLHVCQUFzQmhELElBQUksQ0FBQ2tELE9BQVEsTUFBS3hDLHVCQUFlLHNDQUFxQ1YsSUFBSSxDQUFDOEYsY0FBZSxjQUFhO0lBQ2xJO0lBQ0EsTUFBTS9FLENBQUM7RUFDVDtBQUNGLENBQUM7O0FBVURWLGlCQUFpQixDQUFDK0YsZ0JBQWdCLEdBQUcsU0FBU0EsZ0JBQWdCLENBQUVDLE9BQU8sR0FBRyxFQUFFLEVBQUVaLElBQUksR0FBRyxFQUFFLEVBQUV6RixJQUFJLEdBQUcsQ0FBQyxDQUFDLEVBQUU7RUFDbEcsTUFBTXNHLE9BQU8sR0FBRyxDQUFDLEdBQUdELE9BQU8sRUFBRSxHQUFHLElBQUksQ0FBQ3ZDLFVBQVUsQ0FBQ2tDLFdBQVcsRUFBRSxHQUFHUCxJQUFJLENBQUM7RUFDckVqRixlQUFHLENBQUNDLEtBQUssQ0FBRSxZQUFXQyx1QkFBZSwwQkFBeUJ1RixhQUFJLENBQUNDLEtBQUssQ0FBQ1QsSUFBSSxDQUFFLEVBQUMsQ0FBQztFQUNqRixPQUFPLElBQUl0RSx3QkFBVSxDQUFDLElBQUksQ0FBQzJDLFVBQVUsQ0FBQ1csSUFBSSxFQUFFNkIsT0FBTyxFQUFFdEcsSUFBSSxDQUFDO0FBQzVELENBQUM7QUFBQyxlQUVhSyxpQkFBaUI7QUFBQSJ9