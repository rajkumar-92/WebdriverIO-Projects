"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;
require("source-map-support/register");
var _appiumWebdriveragent = require("appium-webdriveragent");
var _utils = require("./utils");
var _simulatorManagement = require("./simulator-management");
var _asyncbox = require("asyncbox");
const DEFAULT_SIM_NAME = 'iPhone 12';

async function build() {
  const xcodeVersion = await (0, _utils.getAndCheckXcodeVersion)();
  const iosVersion = await (0, _utils.getAndCheckIosSdkVersion)();
  const deviceName = (0, _utils.translateDeviceName)(iosVersion, DEFAULT_SIM_NAME);
  const device = await (0, _simulatorManagement.getExistingSim)({
    platformVersion: iosVersion,
    deviceName
  });
  const wda = new _appiumWebdriveragent.WebDriverAgent(xcodeVersion, {
    iosSdkVersion: iosVersion,
    platformVersion: iosVersion,
    showXcodeLog: true,
    device
  });
  await wda.xcodebuild.start(true);
}
if (require.main === module) {
  (0, _asyncbox.asyncify)(build);
}
var _default = build;
exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJERUZBVUxUX1NJTV9OQU1FIiwiYnVpbGQiLCJ4Y29kZVZlcnNpb24iLCJnZXRBbmRDaGVja1hjb2RlVmVyc2lvbiIsImlvc1ZlcnNpb24iLCJnZXRBbmRDaGVja0lvc1Nka1ZlcnNpb24iLCJkZXZpY2VOYW1lIiwidHJhbnNsYXRlRGV2aWNlTmFtZSIsImRldmljZSIsImdldEV4aXN0aW5nU2ltIiwicGxhdGZvcm1WZXJzaW9uIiwid2RhIiwiV2ViRHJpdmVyQWdlbnQiLCJpb3NTZGtWZXJzaW9uIiwic2hvd1hjb2RlTG9nIiwieGNvZGVidWlsZCIsInN0YXJ0IiwicmVxdWlyZSIsIm1haW4iLCJtb2R1bGUiLCJhc3luY2lmeSJdLCJzb3VyY2VzIjpbIi4uLy4uL2xpYi9idWlsZC13ZGEuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgV2ViRHJpdmVyQWdlbnQgfSBmcm9tICdhcHBpdW0td2ViZHJpdmVyYWdlbnQnO1xuaW1wb3J0IHsgdHJhbnNsYXRlRGV2aWNlTmFtZSwgZ2V0QW5kQ2hlY2tYY29kZVZlcnNpb24sIGdldEFuZENoZWNrSW9zU2RrVmVyc2lvbiB9IGZyb20gJy4vdXRpbHMnO1xuaW1wb3J0IHsgZ2V0RXhpc3RpbmdTaW0gfSBmcm9tICcuL3NpbXVsYXRvci1tYW5hZ2VtZW50JztcbmltcG9ydCB7IGFzeW5jaWZ5IH0gZnJvbSAnYXN5bmNib3gnO1xuXG5jb25zdCBERUZBVUxUX1NJTV9OQU1FID0gJ2lQaG9uZSAxMic7XG5cbi8vIFRPRE86IGFsbG93IHBhc3NpbmcgaW4gYWxsIHRoZSB2YXJpb3VzIGJ1aWxkIHBhcmFtcyBhcyBDTEkgYXJnc1xuYXN5bmMgZnVuY3Rpb24gYnVpbGQgKCkge1xuICBjb25zdCB4Y29kZVZlcnNpb24gPSBhd2FpdCBnZXRBbmRDaGVja1hjb2RlVmVyc2lvbigpO1xuICBjb25zdCBpb3NWZXJzaW9uID0gYXdhaXQgZ2V0QW5kQ2hlY2tJb3NTZGtWZXJzaW9uKCk7XG4gIGNvbnN0IGRldmljZU5hbWUgPSB0cmFuc2xhdGVEZXZpY2VOYW1lKGlvc1ZlcnNpb24sIERFRkFVTFRfU0lNX05BTUUpO1xuICBjb25zdCBkZXZpY2UgPSBhd2FpdCBnZXRFeGlzdGluZ1NpbSh7XG4gICAgcGxhdGZvcm1WZXJzaW9uOiBpb3NWZXJzaW9uLFxuICAgIGRldmljZU5hbWVcbiAgfSk7XG4gIGNvbnN0IHdkYSA9IG5ldyBXZWJEcml2ZXJBZ2VudCh4Y29kZVZlcnNpb24sIHtcbiAgICBpb3NTZGtWZXJzaW9uOiBpb3NWZXJzaW9uLFxuICAgIHBsYXRmb3JtVmVyc2lvbjogaW9zVmVyc2lvbixcbiAgICBzaG93WGNvZGVMb2c6IHRydWUsXG4gICAgZGV2aWNlLFxuICB9KTtcbiAgYXdhaXQgd2RhLnhjb2RlYnVpbGQuc3RhcnQodHJ1ZSk7XG59XG5cbmlmIChyZXF1aXJlLm1haW4gPT09IG1vZHVsZSkge1xuICBhc3luY2lmeShidWlsZCk7XG59XG5cbmV4cG9ydCBkZWZhdWx0IGJ1aWxkO1xuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFFQSxNQUFNQSxnQkFBZ0IsR0FBRyxXQUFXOztBQUdwQyxlQUFlQyxLQUFLLEdBQUk7RUFDdEIsTUFBTUMsWUFBWSxHQUFHLE1BQU0sSUFBQUMsOEJBQXVCLEdBQUU7RUFDcEQsTUFBTUMsVUFBVSxHQUFHLE1BQU0sSUFBQUMsK0JBQXdCLEdBQUU7RUFDbkQsTUFBTUMsVUFBVSxHQUFHLElBQUFDLDBCQUFtQixFQUFDSCxVQUFVLEVBQUVKLGdCQUFnQixDQUFDO0VBQ3BFLE1BQU1RLE1BQU0sR0FBRyxNQUFNLElBQUFDLG1DQUFjLEVBQUM7SUFDbENDLGVBQWUsRUFBRU4sVUFBVTtJQUMzQkU7RUFDRixDQUFDLENBQUM7RUFDRixNQUFNSyxHQUFHLEdBQUcsSUFBSUMsb0NBQWMsQ0FBQ1YsWUFBWSxFQUFFO0lBQzNDVyxhQUFhLEVBQUVULFVBQVU7SUFDekJNLGVBQWUsRUFBRU4sVUFBVTtJQUMzQlUsWUFBWSxFQUFFLElBQUk7SUFDbEJOO0VBQ0YsQ0FBQyxDQUFDO0VBQ0YsTUFBTUcsR0FBRyxDQUFDSSxVQUFVLENBQUNDLEtBQUssQ0FBQyxJQUFJLENBQUM7QUFDbEM7QUFFQSxJQUFJQyxPQUFPLENBQUNDLElBQUksS0FBS0MsTUFBTSxFQUFFO0VBQzNCLElBQUFDLGtCQUFRLEVBQUNuQixLQUFLLENBQUM7QUFDakI7QUFBQyxlQUVjQSxLQUFLO0FBQUEifQ==